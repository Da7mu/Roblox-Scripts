-- GUI Setup
local screenGui = Instance.new("ScreenGui")
screenGui.Name = "CustomToggleGUI"
screenGui.ResetOnSpawn = false
screenGui.Parent = game.Players.LocalPlayer:WaitForChild("PlayerGui")

-- Utility Functions
local function addRoundedCorners(instance, radius)
	local uiCorner = Instance.new("UICorner")
	uiCorner.CornerRadius = UDim.new(0, radius)
	uiCorner.Parent = instance
end

local function addSubtleOutline(instance, thickness)
	local uiStroke = Instance.new("UIStroke")
	uiStroke.Thickness = thickness
	uiStroke.Color = Color3.fromRGB(60, 60, 60)
	uiStroke.ApplyStrokeMode = Enum.ApplyStrokeMode.Border
	uiStroke.Transparency = 0.3
	uiStroke.Parent = instance
end

-- Main Frame
local frame = Instance.new("Frame")
frame.Size = UDim2.new(0, 240, 0, 0)  -- Set height to 0 initially
frame.Position = UDim2.new(0.5, -120, 0.5, -125)  -- Center the frame
frame.BackgroundColor3 = Color3.fromRGB(20, 20, 20)
frame.BackgroundTransparency = 0.05
frame.Active = true
frame.Draggable = true
frame.Parent = screenGui
addRoundedCorners(frame, 12)
addSubtleOutline(frame, 1)

-- Button Factory (Styled)
local function createButton(name, order)
	local button = Instance.new("TextButton")
	button.Size = UDim2.new(1, -24, 0, 32)  -- Full width with no gap
	button.Position = UDim2.new(0, 12, 0, (order - 1) * 38 + 10)  -- Stacked vertically with space between
	button.Text = name .. ": OFF"
	button.TextSize = 16
	button.Font = Enum.Font.Gotham
	button.BackgroundColor3 = Color3.fromRGB(40, 40, 40)
	button.BackgroundTransparency = 0.1
	button.TextColor3 = Color3.fromRGB(255, 255, 255)
	button.AutoButtonColor = false
	button.Parent = frame
	addRoundedCorners(button, 8)
	addSubtleOutline(button, 1)
	return button
end

-- Toggle Buttons
local autoFarmBtn = createButton("Auto Farm", 1)
local autoSellAllBtn = createButton("Auto Sell All", 2)
local autoSellHoldingBtn = createButton("Auto Sell Holding", 3)
local tpBtn = createButton("TP", 4)
tpBtn.Text = "TP"  -- Set the text to just "TP"

-- Adjust the frame size to fit all buttons
frame.Size = UDim2.new(0, 240, 0, (4 * 38) + 20)  -- 4 buttons, each 38px tall + padding

-- State Variables
local autoFarmOn, autoSellAllOn, autoSellHoldingOn = false, false, false
local runningFarm, runningSellAll, runningSellHolding = false, false, false

-- Auto Farm Logic
autoFarmBtn.MouseButton1Click:Connect(function()
	autoFarmOn = not autoFarmOn
	autoFarmBtn.Text = "Auto Farm: " .. (autoFarmOn and "ON" or "OFF")

	if autoFarmOn and not runningFarm then
		runningFarm = true
		task.spawn(function()
			while autoFarmOn do
				local args1 = { [1] = 100, [2] = true }
				local event = game:GetService("ReplicatedStorage").events:FindFirstChild("reelfinished ")
				if event then event:FireServer(unpack(args1)) end

				local args2 = { [1] = 97.4, [2] = 1 }
				local char = game.Players.LocalPlayer.Character
				local rod = char and char:FindFirstChild("Rod Of The Depths")
				if rod and rod:FindFirstChild("events") and rod.events:FindFirstChild("cast") then
					rod.events.cast:FireServer(unpack(args2))
				end
				task.wait(0.5)
			end
			runningFarm = false
		end)
	end
end)

-- Auto Sell All Logic
autoSellAllBtn.MouseButton1Click:Connect(function()
	autoSellAllOn = not autoSellAllOn
	autoSellAllBtn.Text = "Auto Sell All: " .. (autoSellAllOn and "ON" or "OFF")

	if autoSellAllOn and not runningSellAll then
		runningSellAll = true
		task.spawn(function()
			while autoSellAllOn do
				local sellAll = game:GetService("ReplicatedStorage").events:FindFirstChild("SellAll")
				if sellAll then sellAll:InvokeServer() end
				task.wait(10)
			end
			runningSellAll = false
		end)
	end
end)

-- Auto Sell Holding Logic
autoSellHoldingBtn.MouseButton1Click:Connect(function()
	autoSellHoldingOn = not autoSellHoldingOn
	autoSellHoldingBtn.Text = "Auto Sell Holding: " .. (autoSellHoldingOn and "ON" or "OFF")

	if autoSellHoldingOn and not runningSellHolding then
		runningSellHolding = true
		task.spawn(function()
			while autoSellHoldingOn do
				local sellOne = game:GetService("ReplicatedStorage").events:FindFirstChild("Sell")
				if sellOne then sellOne:InvokeServer() end
				task.wait(0.1)
			end
			runningSellHolding = false
		end)
	end
end)

-- TP Logic
tpBtn.MouseButton1Click:Connect(function()
	local TweenService = game:GetService("TweenService")
	local Players = game:GetService("Players")
	local player = Players.LocalPlayer
	local character = player.Character or player.CharacterAdded:Wait()
	local rootPart = character:WaitForChild("HumanoidRootPart")

	local targetPart = workspace:WaitForChild("world"):WaitForChild("spawns"):WaitForChild("TpSpots"):WaitForChild("thedepthsmazeexit")
	local targetCFrame = targetPart.CFrame
	local offset = Vector3.new(0, 5, 0)

	local tweenInfo = TweenInfo.new(2, Enum.EasingStyle.Quad, Enum.EasingDirection.Out)
	local tween = TweenService:Create(rootPart, tweenInfo, {
		CFrame = targetCFrame + offset
	})
	tween:Play()
end)
